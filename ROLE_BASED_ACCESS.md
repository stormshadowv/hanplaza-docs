# üîí –†–æ–ª–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç—É–ø–∞

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ö–∞–∂–¥–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏–º–µ–µ—Ç –ø–æ–ª–µ `allowedRoles`, –∫–æ—Ç–æ—Ä–æ–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é.

### –ú–∞—Ç—Ä–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–∞

| –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –í–∏–¥–∏–º—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |
|-------------------|-------------------|
| `admin` | **–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** |
| `manager` | –ú–µ–Ω–µ–¥–∂–µ—Ä |
| `buyer` | –ó–∞–∫—É–ø—â–∏–∫ |
| `warehouse` | –°–∫–ª–∞–¥—Å–∫–æ–π —Ä–∞–±–æ—Ç–Ω–∏–∫ |
| `designer` | –î–∏–∑–∞–π–Ω–µ—Ä |
| `logistics` | –õ–æ–≥–∏—Å—Ç–∏–∫–∞ |
| `customer-service` | –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ |

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –º–µ–Ω–µ–¥–∂–µ—Ä
```
Email: manager@hanplaza.ru
–ü–∞—Ä–æ–ª—å: password123
```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è "–ú–µ–Ω–µ–¥–∂–µ—Ä"

### 2. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∑–∞–∫—É–ø—â–∏–∫
```
Email: buyer@hanplaza.ru
–ü–∞—Ä–æ–ª—å: password123
```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è "–ó–∞–∫—É–ø—â–∏–∫"

### 3. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω
```
Email: admin@hanplaza.ru
–ü–∞—Ä–æ–ª—å: password123
```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤–∏–¥–Ω—ã –í–°–ï –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ + –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –¢–∞–±–ª–∏—Ü–∞ Category
CREATE TABLE Category (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  description TEXT,
  icon TEXT,
  slug TEXT UNIQUE,
  allowedRoles TEXT DEFAULT '', -- "manager,admin", "all" –∏–ª–∏ "" –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  createdAt DATETIME,
  updatedAt DATETIME
);
```

### API —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```typescript
// –ü—Å–µ–≤–¥–æ–∫–æ–¥ –ª–æ–≥–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
if (userRole === 'admin') {
  return allCategories
}

return categories.filter(category => {
  if (category.allowedRoles === '' || category.allowedRoles === 'all') return true // –î–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º
  return category.allowedRoles.includes(userRole)
})
```

### –ó–∞—â–∏—Ç–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ API

–î–∞–∂–µ –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –æ–±–æ–π—Ç–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ –Ω–∞–ø—Ä—è–º—É—é –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é —á–µ—Ä–µ–∑ API, –¥–æ—Å—Ç—É–ø –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω:

```bash
# –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é "buyer" —Å —Ç–æ–∫–µ–Ω–æ–º –º–µ–Ω–µ–¥–∂–µ—Ä–∞
curl -H "Authorization: Bearer MANAGER_TOKEN" \
  http://localhost:3000/api/categories

# –†–µ–∑—É–ª—å—Ç–∞—Ç: –∫–∞—Ç–µ–≥–æ—Ä–∏—è "buyer" –ù–ï –±—É–¥–µ—Ç –≤ –æ—Ç–≤–µ—Ç–µ
```

## –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –¥–æ—Å—Ç—É–ø–∞

### –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

1. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å `/admin`
3. –í–∫–ª–∞–¥–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é"
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–æ–ª–∏"
5. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é"

### –ß–µ—Ä–µ–∑ API

```bash
curl -X POST http://localhost:3000/api/categories \
  -H "Authorization: Bearer ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è",
    "description": "–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –±—É—Ö–≥–∞–ª—Ç–µ—Ä–æ–≤",
    "icon": "calculator",
    "slug": "accounting",
    "allowedRoles": "accounting,admin"
  }'
```

## –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–æ–ª–∏

- `admin` - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (–≤–∏–¥—è—Ç –≤—Å—ë)
- `manager` - –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º
- `buyer` - –ó–∞–∫—É–ø—â–∏–∫–∏
- `warehouse` - –°–∫–ª–∞–¥—Å–∫–∏–µ —Ä–∞–±–æ—Ç–Ω–∏–∫–∏
- `designer` - –î–∏–∑–∞–π–Ω–µ—Ä—ã
- `logistics` - –õ–æ–≥–∏—Å—Ç—ã
- `customer-service` - –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ä–æ–ª–∏

1. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** —Å –Ω–æ–≤–æ–π —Ä–æ–ª—å—é –≤ `prisma/seed.ts`:
```typescript
{
  email: 'accountant@hanplaza.ru',
  password: hashedPassword,
  name: '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä',
  role: 'accountant', // –ù–æ–≤–∞—è —Ä–æ–ª—å
}
```

2. **–°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é** –¥–ª—è —ç—Ç–æ–π —Ä–æ–ª–∏:
```typescript
{
  slug: 'accounting',
  name: '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è',
  description: '–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –±—É—Ö–≥–∞–ª—Ç–µ—Ä–æ–≤',
  icon: 'calculator',
  allowedRoles: 'accountant,admin',
}
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ seed**:
```bash
npm run db:seed
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚úÖ **–ó–∞—â–∏—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ API** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥  
‚úÖ **JWT —Ç–æ–∫–µ–Ω—ã** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è  
‚úÖ **–†–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–æ–∫–µ–Ω–µ** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å  
‚úÖ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** - –∫–ª–∏–µ–Ω—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, –∫ –∫–æ—Ç–æ—Ä—ã–º –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞

## FAQ

**Q: –ß—Ç–æ –µ—Å–ª–∏ allowedRoles –ø—É—Å—Ç–æ–π –∏–ª–∏ —Ä–∞–≤–µ–Ω "all"?**  
A: –ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

**Q: –ú–æ–∂–µ—Ç –ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –±—ã—Ç—å –≤–∏–¥–Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Ä–æ–ª—è–º?**  
A: –î–∞! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–ø—è—Ç—É—é: `"manager,buyer,admin"`

**Q: –ê–¥–º–∏–Ω—ã –≤—Å–µ–≥–¥–∞ –≤–∏–¥—è—Ç –≤—Å—ë?**  
A: –î–∞, —Ä–æ–ª—å `admin` –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç `allowedRoles`.

**Q: –ú–æ–∂–Ω–æ –ª–∏ —Å–∫—Ä—ã—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–∞–∂–µ –æ—Ç –∞–¥–º–∏–Ω–∞?**  
A: –ù–µ—Ç, —Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å—ë –∞–¥–º–∏–Ω–∞–º. –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω—É–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

